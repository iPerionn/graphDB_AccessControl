(window.webpackJsonp=window.webpackJsonp||[]).push([[2,21,30,72,80,94,110,114,180,181,182,183,184,185,186,189,190,191,192,194,195,203,223,225,227,273],{111:function(e,t,n){"use strict";n.r(t),n.d(t,"buildQueryModel",(function(){return o})),n.d(t,"savedQueriesResponseMapper",(function(){return s})),n.d(t,"savedQueryResponseMapper",(function(){return a})),n.d(t,"queryPayloadFromEvent",(function(){return i}));var r=n(95);const o=(e,t,n,o)=>new r.TabQueryModel(t,e,n,o),s=e=>e&&e.data?e.data.map?e.data.map(e=>o(e.body,e.name,e.owner,e.shared)):[o(e.data.body,e.data.name,e.data.owner,e.data.shared)]:[],a=e=>{const t=s(e);return t.length?t[0]:null},i=e=>({name:e.detail.queryName,body:e.detail.query,shared:e.detail.isPublic})},112:function(e,t,n){"use strict";n.r(t),n.d(t,"EventData",(function(){return r}));class r{constructor(e,t){this.TYPE=e,this.payload=t}}},113:function(e,t,n){"use strict";n.r(t),n.d(t,"QueryRequestEvent",(function(){return r}));class r{constructor(e){this.TYPE=e.TYPE,this.query=e.payload.query,this.queryMode=e.payload.queryMode,this.queryType=e.payload.queryType,this.pageSize=e.payload.pageSize,this.request=e.payload.request}setPageSize(e){this.request._data.pageSize=e}getPageSize(){return this.request._data.pageSize?parseInt(this.request._data.pageSize):void 0}setPageNumber(e){this.request._data.pageNumber=e}getPageNumber(){return this.request._data.pageNumber?parseInt(this.request._data.pageNumber):void 0}setOffset(e){this.request._data.offset=e}setLimit(e){this.request._data.limit=e}}},114:function(e,t,n){"use strict";n.r(t),n.d(t,"CountQueryResponseEvent",(function(){return o}));var r=n(27);class o{constructor(e){this.TYPE=e.TYPE,this.response=e.payload.response}hasResponse(){return this.response&&this.response.body}getResponseBody(){if(this.hasResponse())return this.response.body}isResponseNumber(){return!!this.hasResponse()&&Object(r.isNumber)(this.response.body)}isResponseArray(){return!!this.hasResponse()&&Array.isArray(this.response.body)}getBindings(){if(this.hasResponse())return this.response.body.results.bindings}hasBindingResponse(){return!!this.hasResponse()&&this.response.body.results.bindings[0]}setTotalElements(e){this.response.body.totalElements=e}}},115:function(e,t,n){"use strict";n.r(t),n.d(t,"CountQueryRequestEvent",(function(){return r}));class r{constructor(e){this.TYPE=e.TYPE,this.query=e.payload.query,this.queryMode=e.payload.queryMode,this.queryType=e.payload.queryType,this.pageSize=e.payload.pageSize,this.request=e.payload.request}setPageSize(e){this.request._data.pageSize=e}setPageNumber(e){this.request._data.pageNumber=e}setCount(e){this.request._data.count=e}}},116:function(e,t,n){"use strict";n.r(t),n.d(t,"DownloadAsEvent",(function(){return r}));class r{constructor(e){this.TYPE=e.TYPE,this.contentType=e.payload.value,this.pluginName=e.payload.pluginName,this.query=e.payload.query,this.infer=e.payload.infer,this.sameAs=e.payload.sameAs}}},117:function(e,t,n){"use strict";n.r(t),n.d(t,"NotificationMessageEvent",(function(){return r}));class r{constructor(e){this.TYPE=e.TYPE,this.message=e.payload.message,this.code=e.payload.code,this.messageType=e.payload.messageType}}},118:function(e,t,n){"use strict";n.r(t),n.d(t,"QueryExecutedEvent",(function(){return r}));class r{constructor(e){this.TYPE=e.TYPE,this.duration=e.payload.duration,this.tabId=e.payload.tabId}}},119:function(e,t,n){"use strict";n.r(t),n.d(t,"SaveQueryOpened",(function(){return r}));class r{constructor(e){this.tab=e.payload.tab}getTab(){return this.tab}}},120:function(e,t,n){"use strict";n.r(t),n.d(t,"RequestAbortedEvent",(function(){return r}));class r{constructor(e){this.TYPE=e.TYPE,this.request=e.payload.request,this.queryMode=e.payload.queryMode}getQueryTrackAlias(){if(this.request)return this.request.header["X-GraphDB-Track-Alias"]}getRepository(){if(this.request){const e=this.request.url;return e.substring(e.lastIndexOf("/")+1)}}}},121:function(e,t,n){"use strict";n.r(t),n.d(t,"YasrPluginName",(function(){return r}));const r={EXTENDED_TABLE:"extended_table",RAW_RESPONSE:"response",TABLE:"table"}},162:function(e,t){function n(e){const t=["en","fr"];let n;return{getTranslations:()=>(n||(n={},t.forEach(t=>n[t]=e.getTranslationTable(t))),n)}}angular.module("graphdb.framework.core.services.translation-service",[]).service("TranslationService",n),n.$inject=["$translate"]},163:function(e,t,n){"use strict";n.r(t);var r=n(94);angular.module("graphdb.framework.sparql-editor.share-query.service",[]).factory("ShareQueryLinkService",(function(){return{createShareSavedQueryLink:function(t,n){let o=`${e()}?${r.RouteConstants.savedQueryName}=${encodeURIComponent(t)}`;null!=n&&(o+=`&${r.RouteConstants.savedQueryOwner}=${encodeURIComponent(n)}`);return o},createShareQueryLink:function(t){return e()+"?"+$.param({name:t.name,query:t.body,infer:t.inference||!0,sameAs:t.sameAs||!0})}};function e(){return[location.protocol,"//",location.host,location.pathname].join("")}}))},164:function(e,t,n){"use strict";n.r(t),n.d(t,"toEventData",(function(){return y})),n.d(t,"toYasguiOutputModel",(function(){return g})),n.d(t,"downloadAsFile",(function(){return E}));var r=n(112),o=n(89),s=n(113),a=n(114),i=n(115),u=n(116),c=n(117),d=n(118),l=n(119),p=n(120);const y=e=>new r.EventData(e.detail.TYPE,e.detail.payload),g=e=>{const t=y(e);switch(t.TYPE){case o.EventDataType.DOWNLOAD_AS:return new u.DownloadAsEvent(t);case o.EventDataType.NOTIFICATION_MESSAGE:return new c.NotificationMessageEvent(t);case o.EventDataType.COUNT_QUERY:return new i.CountQueryRequestEvent(t);case o.EventDataType.COUNT_QUERY_RESPONSE:return new a.CountQueryResponseEvent(t);case o.EventDataType.QUERY:return new s.QueryRequestEvent(t);case o.EventDataType.QUERY_EXECUTED:return new d.QueryExecutedEvent(t);case o.EventDataType.SAVE_QUERY_OPENED:return new l.SaveQueryOpened(t);case o.EventDataType.REQUEST_ABORTED:return new p.RequestAbortedEvent(t);default:return t}},E=(e,t,n)=>{const r=document.createElement("a");r.setAttribute("href",`data:${t};charset=utf-8, + ${encodeURIComponent(n)}`),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},165:function(e,t,n){"use strict";n.r(t),n.d(t,"YasguiComponent",(function(){return o}));var r=n(14);class o{constructor(e=r.YasguiComponentDirectiveUtil.getOntotextYasguiElement("#query-editor")){this.yasguiComponent=e}changeRenderMode(e){return this.yasguiComponent.changeRenderMode(e)}setQuery(e){return this.yasguiComponent.setQuery(e)}query(e){return this.yasguiComponent.query(e)}getQuery(){return this.yasguiComponent.getQuery()}isQueryValid(){return this.yasguiComponent.isQueryValid()}openTab(e){return this.yasguiComponent.openTab(e)}getQueryMode(){return this.yasguiComponent.getQueryMode()}getQueryType(){return this.yasguiComponent.getQueryType()}getEmbeddedResultAsJson(){return this.yasguiComponent.getEmbeddedResultAsJson()}getEmbeddedResultAsCSV(){return this.yasguiComponent.getEmbeddedResultAsCSV()}hideYasqeActionButton(e){return this.yasguiComponent.hideYasqeActionButton(e)}showYasqeActionButton(e){return this.yasguiComponent.showYasqeActionButton(e)}abortQuery(){return this.yasguiComponent.abortQuery()}getOngoingRequestsInfo(){return this.yasguiComponent.getOngoingRequestsInfo()}abortAllRequests(){return this.yasguiComponent.abortAllRequests()}reInitYasgui(e){return this.yasguiComponent.reInitYasgui(e)}}},166:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyboardShortcutName",(function(){return r}));const r={TRIGGER_AUTOCOMPLETION:"trigger_autocompletion",DELETE_CURRENT_LINE:"delete_current_line",COMMENT_SELECTED_LINE:"comment_selected_line",COPY_LINE_DOWN:"copy_line_down",COPY_LINE_UP:"copy_line_up",AUTO_FORMAT_SELECTED_LINE:"auto_format_selected_line",INDENT_CURRENT_LINE_MORE:"indent_current_line_more",INDENT_CURRENT_LINE_LESS:"indent_current_line_less",EXECUTE_QUERY_OR_UPDATE:"execute_query_or_update",EXECUTE_EXPLAIN_PLAN_FOR_QUERY:"execute_explain_plan_for_query",EXECUTE_CHAT_GPT_EXPLAIN_PLAN_FOR_QUERY:"execute_chat_gpt_explain_plan_for_query",CREATE_TAB:"create_tab",CREATE_SAVE_QUERY:"create_save_query",SWITCH_NEXT_TAB:"switch_next_tab",SWITCH_PREVIOUS_TAB:"switch_previous_tab",CLOSES_ALL_TABS:"closes_all_tabs",FULL_SCREEN:"full_screen",ESC:"esc"}},167:function(e,t,n){"use strict";n.r(t),n.d(t,"YasguiPersistenceMigrationService",(function(){return i}));var r=n(97);const o="yagui__"+r.VIEW_SPARQL_EDITOR,s="completed",a="rejected",i=function(){const e=()=>({val:{active:null,tabs:[],tabConfig:{}}}),t=(e,t,n=null)=>{e.val.migration={date:(new Date).toISOString(),status:t,error:n}},n=(e,t)=>{e.val.tabs.push(t)},r=(e,t)=>{e.val.tabConfig[t.id]=t},i=e=>{let t=localStorage.getItem(e);if(t)return t=JSON.parse(t),t},u=e=>{e.val.tabs=e.val.tabs.filter(e=>!e.startsWith("_"))},c=e=>{for(const t in e.val.tabConfig)t.startsWith("_")&&delete e.val.tabConfig[t]},d=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},l=(e,t)=>`${t} ${e}`,p=()=>Math.random().toString(36).substring(7);return{isMigrationNeeded:()=>{const e=i(o);let t=!1;return e&&(t=e.val.migration&&(e.val.migration.status===s||e.val.migration.status===a)),!(!localStorage.getItem("ls.tabs-state")||t)},revertMigration:()=>{const e=i(o);u(e),c(e),d(o,e)},migrateYasguiPersistence:a=>{let u=i("ls.tabs-state");u=Object.freeze(u);let c=i(o);c||(c=e()),u.map(e=>({id:e.id,name:e.name,yasqe:{value:e.query,sameAs:e.sameAs,infer:e.inference,pageSize:1e3,pageNumber:1},yasr:{response:null,settings:{selectedPlugin:"extended_table",pluginsConfig:{}}},requestConfig:{method:"POST"}})).forEach((e,t)=>{e.id="_"+p(),e.name=e.name||l(t,a),n(c,e.id),r(c,e)}),c.val.active=c.val.tabs[0],t(c,s),d(o,c)},rejectMigration:()=>{const e=i(o);t(e,a),d(o,e)}}}()},465:function(e,t,n){var r,o=o||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o=e.webkitRequestFileSystem,s=e.requestFileSystem||o||e.mozRequestFileSystem,a=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},i=0,u=function(t){var r=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?r():setTimeout(r,500)},c=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){a(e)}}},d=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},l=function(t,a){t=d(t);var l,p,y,g=this,E=t.type,m=!1,f=function(){c(g,"writestart progress write writeend".split(" "))},h=function(){(!m&&l||(l=n().createObjectURL(t)),p)?p.location.href=l:null==e.open(l,"_blank")&&"undefined"!=typeof safari&&(e.location.href=l);g.readyState=g.DONE,f(),u(l)},S=function(e){return function(){if(g.readyState!==g.DONE)return e.apply(this,arguments)}},T={create:!0,exclusive:!1};if(g.readyState=g.INIT,a||(a="download"),r)return l=n().createObjectURL(t),r.href=l,r.download=a,void setTimeout((function(){var e,t;e=r,t=new MouseEvent("click"),e.dispatchEvent(t),f(),u(l),g.readyState=g.DONE}));e.chrome&&E&&"application/octet-stream"!==E&&(y=t.slice||t.webkitSlice,t=y.call(t,0,t.size,"application/octet-stream"),m=!0),o&&"download"!==a&&(a+=".download"),("application/octet-stream"===E||o)&&(p=e),s?(i+=t.size,s(e.TEMPORARY,i,S((function(e){e.root.getDirectory("saved",T,S((function(e){var n=function(){e.getFile(a,T,S((function(e){e.createWriter(S((function(n){n.onwriteend=function(t){p.location.href=e.toURL(),g.readyState=g.DONE,c(g,"writeend",t),u(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&h()},"writestart progress write abort".split(" ").forEach((function(e){n["on"+e]=g["on"+e]})),n.write(t),g.abort=function(){n.abort(),g.readyState=g.DONE},g.readyState=g.WRITING})),h)})),h)};e.getFile(a,{create:!1},S((function(e){e.remove(),n()})),S((function(e){e.code===e.NOT_FOUND_ERR?n():h()})))})),h)})),h)):h()},p=l.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t){return navigator.msSaveOrOpenBlob(d(e),t)}:(p.abort=function(){this.readyState=this.DONE,c(this,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,function(e,t){return new l(e,t)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=o:null!==n(476)&&null!=n(464)&&(void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r))},88:function(e,t,n){"use strict";function r(e,t,n,r,o){e.JSONLDModes=[{name:"framed",link:"http://www.w3.org/ns/json-ld#framed"},{name:"expanded",link:"http://www.w3.org/ns/json-ld#expanded"},{name:"flattened",link:"http://www.w3.org/ns/json-ld#flattened"},{name:"compacted",link:"http://www.w3.org/ns/json-ld#compacted"}],e.JSONLDModesNames=e.JSONLDModes.reduce((function(e,t){return e[t.name]=t.name,e}),{}),e.JSONLDFramedModes=[e.JSONLDModesNames.framed],e.JSONLDContextModes=[e.JSONLDModesNames.compacted,e.JSONLDModesNames.flattened],e.defaultMode=e.JSONLDModes.find(e=>"expanded"===e.name),e.currentMode=e.defaultMode,e.link=null,e.fileFormat=o.toLowerCase(),e.setJSONLDSettingsToLocalStorage=function(e,t,o){n.set(r.JSONLD_EXPORT_SETTINGS,JSON.stringify({jsonldFormName:e,jsonldFormLink:t,jsonldLink:o}))},e.cancel=function(){t.dismiss()},e.reset=function(){e.currentMode=e.defaultMode,e.link="",e.setJSONLDSettingsToLocalStorage(e.currentMode.name,e.currentMode.link,e.link)},e.clearLinkInput=function(){e.link="",e.setJSONLDSettingsToLocalStorage(e.currentMode.name,e.currentMode.link,e.link)},e.exportJsonLD=function(){e.setJSONLDSettingsToLocalStorage(e.currentMode.name,e.currentMode.link,e.link),t.close({currentMode:e.currentMode,link:e.link})};!function(){const t=n.get(r.JSONLD_EXPORT_SETTINGS);t&&(e.currentMode=e.JSONLDModes.find(e=>e.name===t.jsonldFormName),e.link=t.jsonldLink)}()}n.r(t),n.d(t,"ExportSettingsCtrl",(function(){return r})),angular.module("graphdb.framework.core.components.export-settings-modal",["graphdb.framework.utils.localstorageadapter"]).controller("ExportSettingsCtrl",r),r.$inject=["$scope","$uibModalInstance","LocalStorageAdapter","LSKeys","format"]},89:function(e,t,n){"use strict";n.r(t),n.d(t,"EventDataType",(function(){return r}));const r={DOWNLOAD_AS:"downloadAs",NOTIFICATION_MESSAGE:"notificationMessage",QUERY:"query",COUNT_QUERY:"countQuery",COUNT_QUERY_RESPONSE:"countQueryResponse",REQUEST_ABORTED:"requestAborted",QUERY_EXECUTED:"queryExecuted",SAVE_QUERY_OPENED:"saveQueryOpened"}},93:function(e,t,n){"use strict";n.r(t);n(162),n(163);var r=n(111),o=n(27),s=n(465),a=n(164),i=n(89),u=n(12),c=n(121),d=n(561),l=n(96),p=n(165),y=n(14),g=n(166),E=n(167),m=n(88);function f(e,t,n,f,h,S,T,v,_,R,b,O,N,C,A,w){return{restrict:"E",templateUrl:"js/angular/core/directives/yasgui-component/templates/yasgui-component.html",scope:{yasguiConfig:"=",afterInit:"&",queryChanged:"&"},link:(f,w,q)=>{f.classToApply=q.class||"";const Q=new Map,L=f.yasguiConfig&&f.yasguiConfig.outputHandlers?new Map(f.yasguiConfig.outputHandlers):new Map;let D=void 0;f.getOntotextYasguiElements=()=>w.find("ontotext-yasgui"),f.getOntotextYasguiElement=()=>new p.YasguiComponent(f.getOntotextYasguiElements()[0]),f.createSavedQuery=e=>{const t=Object(r.queryPayloadFromEvent)(e);C.addNewSavedQuery(t).then(()=>z(t)).catch(J)},f.updateSavedQuery=e=>{const t=Object(r.queryPayloadFromEvent)(e);C.editSavedQuery(t).then(()=>X(t)).catch(J)},f.deleteSavedQuery=e=>{const t=Object(r.queryPayloadFromEvent)(e);C.deleteSavedQuery(t.name).then(()=>{_.success(n.instant("query.editor.delete.saved.query.success.msg",{savedQueryName:t.name}))}).catch(e=>{const t=getError(e);_.error(t,n.instant("query.editor.delete.saved.query.error"))})},f.shareSavedQuery=e=>{const t=Object(r.queryPayloadFromEvent)(e);f.savedQueryConfig={shareQueryLink:A.createShareSavedQueryLink(t.name,t.owner)}},f.shareQuery=e=>{const t=Object(r.queryPayloadFromEvent)(e);f.savedQueryConfig={shareQueryLink:A.createShareQueryLink(t)}},f.queryShareLinkCopied=()=>{_.success(n.instant("modal.ctr.copy.url.success"))},f.loadSavedQueries=()=>{C.getSavedQueries().then(e=>{const t=Object(r.savedQueriesResponseMapper)(e);f.savedQueryConfig={savedQueries:t}}).catch(e=>{const t=getError(e);_.error(t,n.instant("query.editor.get.saved.queries.error"))})},f.saveQueryOpened=e=>{y.YasguiComponentDirectiveUtil.highlightTabName(Object(a.toYasguiOutputModel)(e).getTab())},f.output=e=>{const t=Object(a.toYasguiOutputModel)(e);L.has(t.TYPE)&&L.get(t.TYPE)(t)};L.set(i.EventDataType.QUERY,e=>{const t=e.getPageNumber(),n=e.getPageSize();n&&t&&(e.setOffset((t-1)*(n-1)),e.setLimit(n)),e.setPageNumber(void 0),e.setPageSize(void 0)});L.set(i.EventDataType.COUNT_QUERY,e=>{e.setPageSize(void 0),e.setPageNumber(void 0),e.setCount(1)});L.set(i.EventDataType.COUNT_QUERY_RESPONSE,e=>{e.setTotalElements(B(e))});L.set(i.EventDataType.DOWNLOAD_AS,e=>{const t=Q.get(e.pluginName);t&&t(e)});L.set(i.EventDataType.NOTIFICATION_MESSAGE,e=>{const t=_[e.messageType];Object(o.isFunction)(t)&&t(e.message)});Q.set("extended_response",e=>{"application/sparql-results+json"===e.contentType?f.getOntotextYasguiElement().getEmbeddedResultAsJson().then(t=>{const n=JSON.stringify(t,null,"\t");Object(a.downloadAsFile)(j()+"_queryResults.json",e.contentType,n)}):"text/csv"===e.contentType&&f.getOntotextYasguiElement().getEmbeddedResultAsCSV().then(t=>{Object(a.downloadAsFile)(j()+"_queryResults.csv",e.contentType,t)})});const P=(e,r,o,a,i,u)=>{const c={query:e,infer:r,sameAs:o,authToken:a};O.downloadResultsAsFile(t.getActiveRepository(),c,i,u).then((function({data:e,filename:t}){Object(s.saveAs)(e,t)})).catch((function(e){e.data.text().then(t=>{431===e.status?_.error(e.statusText,n.instant("common.error")):_.error(t,n.instant("common.error"))})})).finally(()=>{f.setLoader(!1)})};Q.set(c.YasrPluginName.EXTENDED_TABLE,e=>{const t=e.query,n=e.infer,r=e.sameAs,o=e.contentType,s=T.getAuthToken()||"";if("application/ld+json"===e.contentType||"application/x-ld+ndjson"===e.contentType){S.open({templateUrl:"js/angular/core/components/export-settings-modal/exportSettingsModal.html",controller:m.ExportSettingsCtrl,size:"lg",scope:f,resolve:{format:function(){return"application/ld+json"===e.contentType?"JSON-LD":"NDJSON-LD"}}}).result.then((function(e){const a="framed"===e.currentMode.name?"frame":"context",i=o+";profile="+e.currentMode.link,u=e.link?`<${e.link}>; rel="http://www.w3.org/ns/json-ld#${a}"`:"";P(t,n,r,s,i,u)}))}else P(t,n,r,s,o,"")});const M=[],Y=()=>f.getOntotextYasguiElement().getQuery().then(e=>{D=JSON.stringify(e)});M.push(f.$watch("yasguiConfig",(r,o)=>{if(!f.ontotextYasguiConfig&&r||r&&!Object(d.isEqual)(r,o)){const o=t.isActiveRepoOntopType(),s={isVirtualRepository:o,infer:o||r.infer,immutableInfer:o,sameAs:o||r.sameAs,immutableSameAs:o,yasqeAutocomplete:{LocalNamesAutocompleter:t=>{const n=e.defer();return W(t,n)}},language:h.getLanguage(),i18n:R.getTranslations(),getRepositoryStatementsCount:V,onQueryAborted:K};if(angular.extend(s,$(),f.yasguiConfig),void 0===s.showQueryButton||s.showQueryButton){const e=s.keyboardShortcutConfiguration||{};e[g.KeyboardShortcutName.EXECUTE_EXPLAIN_PLAN_FOR_QUERY]=!0,e[g.KeyboardShortcutName.EXECUTE_CHAT_GPT_EXPLAIN_PLAN_FOR_QUERY]=!0,s.keyboardShortcutConfiguration=e}else{const e=s.keyboardShortcutConfiguration||{};e[g.KeyboardShortcutName.EXECUTE_QUERY_OR_UPDATE]=!1,e[g.KeyboardShortcutName.EXECUTE_EXPLAIN_PLAN_FOR_QUERY]=!1,e[g.KeyboardShortcutName.EXECUTE_CHAT_GPT_EXPLAIN_PLAN_FOR_QUERY]=!1,e[g.KeyboardShortcutName.CREATE_TAB]=!1,e[g.KeyboardShortcutName.CREATE_SAVE_QUERY]=!1,e[g.KeyboardShortcutName.SWITCH_NEXT_TAB]=!1,e[g.KeyboardShortcutName.SWITCH_PREVIOUS_TAB]=!1,e[g.KeyboardShortcutName.CLOSES_ALL_TABS]=!1,s.keyboardShortcutConfiguration=e}E.YasguiPersistenceMigrationService.isMigrationNeeded()&&E.YasguiPersistenceMigrationService.migrateYasguiPersistence(n.instant("sparql.tab.directive.unnamed.tab.title")),f.ontotextYasguiConfig=s,U(),Y().then(()=>{angular.isFunction(f.afterInit)&&f.afterInit()})}}));const I=()=>{let e;const t=f.getOntotextYasguiElement();t.getQuery().then(t=>(e=JSON.stringify(t),e)).then(C.addKnownPrefixes).then(n=>{e=n.data,t.setQuery(e)}).then(()=>{x(JSON.stringify(e))}).catch(e=>{const t=getError(e);_.error(t,n.instant("common.add.known.prefixes.error"))})},U=()=>{const e=v((function(){const t=f.getOntotextYasguiElements();t&&(t.on("paste.sparqlQuery",".CodeMirror",I),t.on("keyup.sparqlQuery",".CodeMirror textarea",k),v.cancel(e))}))},k=e=>{f.getOntotextYasguiElement().getQuery().then(e=>{x(JSON.stringify(e))})},x=e=>{f.queryChanged(e),f.$emit("queryChanged",{dirty:D!==e})};M.push(f.$on("language-changed",(function(e,t){f.language=t.locale})));f.$on("$destroy",()=>{M.forEach(e=>e());const e=f.getOntotextYasguiElements();e.off("paste.sparqlQuery"),e.off("keyup.sparqlQuery")});const j=()=>{const e=new Date;return`${e.toLocaleDateString(f.language)}_${e.toLocaleTimeString(f.language)}`},B=e=>{if(e.isResponseNumber())return e.getResponseBody();if(e.isResponseArray()){const t=e.getResponseBody();if(t["http://www.ontotext.com/"])return t["http://www.ontotext.com/"]["http://www.ontotext.com/"][0].value}if(e.hasBindingResponse()){const t=e.getResponseBody();if(t){const e=t.results.bindings[0],n=t.head.vars,r=Object.keys(e).find((function(t){return n.indexOf(t)>-1&&!isNaN(e[t].value)}));if(r.length>0)return e[r].value}}},F=e=>{const n=e.getTab().getYasqe(),r={"Content-Type":"application/x-www-form-urlencoded","X-GraphDB-Local-Consistency":"updating","X-GraphDB-Catch":n.getPageSize()+"; throw","X-GraphDB-Track-Alias":`yasgui-component-${performance.now()}-${Date.now()}`,"X-GraphDB-Repository-Location":t.getActiveRepositoryObject().location,"X-Requested-With":"XMLHttpRequest"},o=T.getAuthToken();o&&(r.Authorization=o);const s=n.getQueryType();return u.QueryMode.UPDATE===n.getQueryMode()?r.Accept="text/plain,/;q=0.9":l.QueryType.CONSTRUCT===s||l.QueryType.DESCRIBE===s?r.Accept="application/x-graphdb-table-results+json, application/rdf+json;q=0.9, */*;q=0.8":r.Accept="application/x-sparqlstar-results+json, application/sparql-results+json;q=0.9, */*;q=0.8",r},$=()=>({showEditorTabs:!0,showToolbar:!0,componentId:"yasgui-component",headers:F,pageSize:1e3,maxPersistentResponseSize:5e5,showResultTabs:!0}),J=e=>{const t=getError(e),r=n.instant("query.editor.create.saved.query.error");_.error(t,r),f.savedQueryConfig=Object(o.merge)({},f.savedQueryConfig,{saveSuccess:!1,errorMessage:[r]})},X=e=>G(n.instant("query.editor.edit.saved.query.success.msg",{name:e.name})),z=e=>G(n.instant("query.editor.save.saved.query.success.msg",{name:e.name})),G=e=>{_.success(e),f.savedQueryConfig=Object(o.merge)({},f.savedQueryConfig,{saveSuccess:!0})},W=(e,t)=>b.getAutocompleteSuggestions(e,t.promise).then((function(e){return t=null,e.data})),V=()=>O.getRepositorySize(t.getActiveRepository()).then(e=>parseInt(e.data)).catch((function(e){const r={repo:t.getActiveRepository(),error:getError(e)};_.warning(n.instant("query.editor.repo.size.error",r))})),K=e=>{if(e){const t=e.url.substring(e.url.lastIndexOf("/")+1),n=e.header["X-GraphDB-Track-Alias"];return N.deleteQuery(n,t)}}}}}angular.module("graphdb.framework.core.directives.yasgui-component",["graphdb.framework.core.services.translation-service","graphdb.framework.sparql-editor.share-query.service"]).directive("yasguiComponent",f),f.$inject=["$q","$repositories","$translate","$location","$languageService","$uibModal","AuthTokenService","$interval","toastr","TranslationService","AutocompleteRestService","RDF4JRepositoriesRestService","MonitoringRestService","SparqlRestService","ShareQueryLinkService","ModalService"]},94:function(e,t,n){"use strict";n.r(t),n.d(t,"RouteConstants",(function(){return r}));const r={savedQueryName:"savedQueryName",savedQueryOwner:"owner",query:"query",name:"name",owner:"owner"}},95:function(e,t,n){"use strict";n.r(t),n.d(t,"TabQueryModel",(function(){return r}));class r{constructor(e,t,n,r=!0){this.queryName=e,this.query=t,this.owner=n,this.isPublic=r}}},96:function(e,t,n){"use strict";n.r(t),n.d(t,"QueryType",(function(){return r}));const r={SELECT:"SELECT",CONSTRUCT:"CONSTRUCT",ASK:"ASK",DESCRIBE:"DESCRIBE",INSERT:"INSERT",DELETE:"DELETE",LOAD:"LOAD",CLEAR:"CLEAR",CREATE:"CREATE",DROP:"DROP",COPY:"COPY",MOVE:"MOVE",ADD:"ADD"}},97:function(e,t,n){"use strict";n.r(t),n.d(t,"VIEW_SPARQL_EDITOR",(function(){return r}));const r="graphdb-workbench-sparql-editor"}}]);