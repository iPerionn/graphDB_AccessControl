(window.webpackJsonp=window.webpackJsonp||[]).push([[7,53,69,153,155,156],{110:function(t,e,n){"use strict";n.r(e),n.d(e,"NodeState",(function(){return s}));const s={LEADER:"LEADER",FOLLOWER:"FOLLOWER",CANDIDATE:"CANDIDATE",OUT_OF_SYNC_BLANK:"OUT_OF_SYNC_BLANK"}},158:function(t,e,n){"use strict";n.r(e);var s=n(159),a=n(87),r=n(75);function o(t,e,n,o){return{restrict:"E",templateUrl:"js/angular/clustermanagement/templates/cluster-legend.html",scope:{},link:N=>{N.hideLegend=!0;const i=[];let c,E,_;N.toggleLegend=()=>{N.hideLegend=!N.hideLegend,c.classed("hidden-legend",N.hideLegend)};const l=()=>{const t=e.getClusterViewD3Container();u(t),A(),T(c),d(),S(),O(),L()},T=t=>{C(t,"cluster_management.cluster_graphical_view.legend_title_node_state");const e=t.selectAll(".node-group").data(s.CLUSTER_MANAGEMENT_CONSTANTS.getLegendNodes()),n=a.createNodes(e,s.CLUSTER_MANAGEMENT_CONSTANTS.SVG_NODE_WIDTH,!0);a.updateNodes(n);n.attr("transform",(function(t,e){return O(),`translate(${s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_PADDING_LEFT}, ${E+s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_PADDING_TOP})`})).append("text").style("font-size",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_SIZE).style("line-height",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_LINE_HEIGHT).style("font-weight",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_WEIGHT).style("fill",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_COLOR).attr("x",s.CLUSTER_MANAGEMENT_CONSTANTS.PADDING_LEFT+s.CLUSTER_MANAGEMENT_CONSTANTS.SVG_NODE_WIDTH).attr("y",3).text((function(t){return f(this,"cluster_management.cluster_graphical_view."+t.customText)}))},d=()=>{C(c,"cluster_management.cluster_graphical_view.legend_title_sync_status");const t=c.selectAll(".sync-statuses-group").data(s.CLUSTER_MANAGEMENT_CONSTANTS.getSyncStatuses()).enter().append("g").attr("class","sync-statuses-group"),e=new Map;t.append("text").classed("sync-status",!0).attr("class",t=>t.classes).style("font-size",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_ICON_FONT_SIZE).style("line-height",s.CLUSTER_MANAGEMENT_CONSTANTS.TITLE_LINE_HEIGHT).attr("x",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_PADDING_LEFT-10).attr("y",(function(t,n){const a=n*(20+s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_PADDING_TOP)+E+s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEMS_PADDING_TOP;return e.set(n,a),a})).text((function(t){return t.icon}));const n=(s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_ICON_FONT_SIZE-s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_SIZE)/2;t.append("text").style("font-size",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_SIZE).style("line-height",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_LINE_HEIGHT).style("font-weight",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_WEIGHT).style("fill",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_COLOR).text((function(t){return f(this,"cluster_management.cluster_graphical_view."+t.labelKey)})).attr("x",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_PADDING_LEFT+s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_SIZE).attr("y",(function(t,s){return e.get(s)-n})).classed("links-statuses",!0)},S=()=>{C(c,"cluster_management.cluster_graphical_view.legend_title_link_states");const t=c.selectAll(".link-states-group").data(s.CLUSTER_MANAGEMENT_CONSTANTS.getLegendLinks()).enter().append("g").attr("class","link-state"),e=new Map;t.append("path").classed("link",!0).attr("stroke-dasharray",a.setLinkStyle).attr("stroke",a.setLinkColor).attr("d",(t,n)=>{const a=n*(s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_SIZE+s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_PADDING_TOP)+E+s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEMS_PADDING_TOP,o=_/2;let N;if(e.set(n,a),t.status===r.LinkState.RECEIVING_SNAPSHOT){const t=o/2;N=`M${s.CLUSTER_MANAGEMENT_CONSTANTS.PADDING_LEFT},${a},L${t},${a},L${o},${a}`}else N=`M${s.CLUSTER_MANAGEMENT_CONSTANTS.PADDING_LEFT},${a},${o},${a}`;return N}).style("marker-mid",t=>a.setArrowLink(t,a.ARROW_CONFIG.SMALL)),t.append("text").style("font-size",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_SIZE).style("line-height",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_LINE_HEIGHT).style("font-weight",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_FONT_WEIGHT).style("fill",s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_COLOR).text((function(t){return f(this,"cluster_management.cluster_graphical_view."+t.linkTypeKey)})).attr("x",_/2+s.CLUSTER_MANAGEMENT_CONSTANTS.LEGEND_ITEM_PADDING_LEFT).attr("y",(function(t,n){return e.get(n)+4})).classed("links-statuses",!0)},u=t=>{c=t.append("g").classed("hidden-legend",N.hideLegend).classed("cluster-legend-group",!0)},A=()=>{c.append("rect").attr("class","legend-background").attr("fill","#EEEEEE")},O=()=>{c.call(t=>{E=t.node().getBBox().height}),_=I(c)+30},L=()=>{const t=I(c);c.select(".legend-background").attr("height",E+3*s.CLUSTER_MANAGEMENT_CONSTANTS.PADDING_TOP).attr("width",t+s.CLUSTER_MANAGEMENT_CONSTANTS.BACKGROUND_PADDING).attr("rx","6")},I=t=>{let e=0;return t.selectAll(":not(.legend-background)").each((function(){const t=this.getBBox();e=Math.max(e,t.width)})),e},C=(t,e)=>t.append("text").attr("class","legend-title").attr("x",s.CLUSTER_MANAGEMENT_CONSTANTS.PADDING_LEFT).style("font-size",s.CLUSTER_MANAGEMENT_CONSTANTS.TITLE_FONT_SIZE).style("font-weight",s.CLUSTER_MANAGEMENT_CONSTANTS.TITLE_FONT_WEIGHT).style("line-height",s.CLUSTER_MANAGEMENT_CONSTANTS.TITLE_LINE_HEIGHT).style("fill",s.CLUSTER_MANAGEMENT_CONSTANTS.TITLE_COLOR).text((function(){return f(this,e)})).attr("y",()=>(O(),E+s.CLUSTER_MANAGEMENT_CONSTANTS.TITLE_PADDING_TOP)),f=(e,s)=>(i.push(t.$on("$translateChangeSuccess",()=>{d3.select(e).text(n.instant(s)),L()})),n.instant(s)),h=()=>{N.hideLegend=!0,c.classed("hidden-legend",N.hideLegend)};o.on("keydown",t=>{"Escape"===t.key&&h()}),i.push(e.onClusterViewD3ContainerUpdated(l)),N.$on("$destroy",()=>{o.off("keydown",h),i.forEach(t=>t())}),l()}}}angular.module("graphdb.framework.clustermanagement.directives.cluster-legend",[]).directive("clusterLegend",o),o.$inject=["$rootScope","ClusterViewContextService","$translate","$document"]},159:function(t,e,n){"use strict";n.r(e),n.d(e,"CLUSTER_MANAGEMENT_CONSTANTS",(function(){return r}));var s=n(110),a=n(75);const r={getLegendNodes:function(){const t=[];return t.push({nodeState:s.NodeState.LEADER,customText:"node_state_leader"}),t.push({nodeState:s.NodeState.FOLLOWER,customText:"node_state_follower"}),t.push({nodeState:s.NodeState.OUT_OF_SYNC_BLANK,customText:"node_state_out_of_sync"}),t.forEach((t,e)=>t.id=e),t},getSyncStatuses:()=>[{labelKey:"node_state_candidate",classes:"icon-any",icon:""},{labelKey:"node_state_no_cluster",classes:"close",icon:"X"},{labelKey:"link_state_out_of_sync",classes:"icon-any",icon:""},{labelKey:"node_state_no_connection",classes:"icon-any",icon:""},{labelKey:"node_state_read_only",classes:"icon-any",icon:""},{labelKey:"node_state_restricted",classes:"icon-any",icon:""},{labelKey:"recovery_state.searching_for_node",classes:"fa-d3",icon:""},{labelKey:"recovery_state.waiting_for_snapshot",classes:"fa-d3",icon:""},{labelKey:"recovery_state.building_snapshot",classes:"fa-d3",icon:""},{labelKey:"recovery_state.sending_snapshot",classes:"fa-d3",icon:""},{labelKey:"recovery_state.receiving_snapshot",classes:"fa-d3",icon:""},{labelKey:"recovery_state.applying_snapshot",classes:"fa-d3",icon:""}],getLegendLinks:function(){const t=[];return t.push({status:a.LinkState.IN_SYNC,linkTypeKey:"link_state_in_sync"}),t.push({status:a.LinkState.SYNCING,linkTypeKey:"link_state_syncing"}),t.push({status:a.LinkState.OUT_OF_SYNC,linkTypeKey:"link_state_out_of_sync"}),t.push({status:a.LinkState.RECEIVING_SNAPSHOT,linkTypeKey:"link_state_receiving_snapshot"}),t.forEach((t,e)=>t.id=e),t},SVG_NODE_WIDTH:15,PADDING_LEFT:12,PADDING_TOP:12,TITLE_PADDING_TOP:15,TITLE_FONT_SIZE:13,TITLE_FONT_WEIGHT:700,TITLE_COLOR:"#000000",TITLE_LINE_HEIGHT:18,LEGEND_ITEM_FONT_SIZE:11,LEGEND_ITEM_ICON_FONT_SIZE:15,LEGEND_ITEM_FONT_WEIGHT:400,LEGEND_ITEM_COLOR:"#000000",LEGEND_ITEM_LINE_HEIGHT:13,LEGEND_ITEM_PADDING_LEFT:27,LEGEND_ITEMS_PADDING_TOP:40,LEGEND_ITEM_PADDING_TOP:8,BACKGROUND_PADDING:24}},75:function(t,e,n){"use strict";n.r(e),n.d(e,"NodeState",(function(){return s})),n.d(e,"RecoveryState",(function(){return a})),n.d(e,"LinkState",(function(){return r}));const s={LEADER:"LEADER",FOLLOWER:"FOLLOWER",CANDIDATE:"CANDIDATE",OUT_OF_SYNC:"OUT_OF_SYNC",NO_CONNECTION:"NO_CONNECTION",READ_ONLY:"READ_ONLY",RESTRICTED:"RESTRICTED",NO_CLUSTER:"NO_CLUSTER"},a={SEARCHING_FOR_NODE:"SEARCHING_FOR_NODE",WAITING_FOR_SNAPSHOT:"WAITING_FOR_SNAPSHOT",RECEIVING_SNAPSHOT:"RECEIVING_SNAPSHOT",APPLYING_SNAPSHOT:"APPLYING_SNAPSHOT",BUILDING_SNAPSHOT:"BUILDING_SNAPSHOT",SENDING_SNAPSHOT:"SENDING_SNAPSHOT",RECOVERY_OPERATION_FAILURE_WARNING:"RECOVERY_OPERATION_FAILURE_WARNING"},r={IN_SYNC:"IN_SYNC",OUT_OF_SYNC:"OUT_OF_SYNC",SYNCING:"SYNCING",NO_CONNECTION:"NO_CONNECTION",RECEIVING_SNAPSHOT:"RECEIVING_SNAPSHOT"}},87:function(t,e,n){"use strict";n.r(e),n.d(e,"createClusterSvgElement",(function(){return l})),n.d(e,"createClusterZone",(function(){return T})),n.d(e,"setCreateClusterZone",(function(){return d})),n.d(e,"updateClusterZoneLabels",(function(){return S})),n.d(e,"moveElement",(function(){return u})),n.d(e,"createNodes",(function(){return A})),n.d(e,"updateNodes",(function(){return O})),n.d(e,"createLinks",(function(){return h})),n.d(e,"updateLinks",(function(){return G})),n.d(e,"ARROW_CONFIG",(function(){return y})),n.d(e,"addArrowHead",(function(){return g})),n.d(e,"setArrowLink",(function(){return p})),n.d(e,"setLinkColor",(function(){return M})),n.d(e,"setLinkStyle",(function(){return D})),n.d(e,"positionNodesOnClusterZone",(function(){return R})),n.d(e,"createHexagon",(function(){return m})),n.d(e,"removeEventListeners",(function(){return v}));var s=n(75),a=n(27);const r="var(--primary-color)",o="var(--secondary-color)",N="var(--gray-color)",i={[s.LinkState.IN_SYNC]:o,[s.LinkState.SYNCING]:o,[s.LinkState.OUT_OF_SYNC]:N,[s.LinkState.RECEIVING_SNAPSHOT]:o},c={[s.LinkState.IN_SYNC]:"none",[s.LinkState.SYNCING]:"10 10",[s.LinkState.OUT_OF_SYNC]:"10 10",[s.LinkState.RECEIVING_SNAPSHOT]:"10 10"},E="FONT_AWESOME",_="ICOMOON";function l(t){return d3.select(t).append("svg").classed("cluster-diagram",!0)}function T(t){const e=t.append("g");return e.append("circle").classed("cluster-zone",!0).style("fill","transparent").style("stroke-width","4"),e}function d(t,e,n,s=!1){if(e.select(".cluster-zone").classed("no-cluster",!t).classed("has-access",s),t)e.selectAll("#no-cluster-zone").remove();else{const t=e.append("g").attr("id","no-cluster-zone");t.append("text").attr("id","no-cluster-label").text(n.no_cluster_configured).attr("y",-50).classed("h2",!0).style("text-anchor","middle"),s&&t.append("text").attr("id","create-cluster-label").classed("h3",!0).text(n.create_cluster_btn).style("text-anchor","middle"),t.append("text").attr("y",130).attr("class","icon-any repo").attr("fill",r).style("text-anchor","middle").classed("settings-icon",!0).text("")}}function S(t,e,n){t||(e.select("#no-cluster-zone #no-cluster-label").text(n.no_cluster_configured),e.select("#no-cluster-zone #create-cluster-label").text(n.create_cluster_btn))}function u(t,e,n){t.attr("transform",()=>`translate(${e}, ${n})`)}function A(t,e,n){const s=t.enter().append("g").attr("id","node-group").classed("legend",n),a=s.merge(t).attr("id","node-group").classed("legend",n);return m(s,e),t.exit().remove(),s.append("text").attr("class","icon-any node-icon"),n||function(t,e){const n=t.append("g");n.append("rect").attr("class","id-host-background").attr("rx",6),n.append("rect").attr("class","node-info-background").attr("rx",6),n.append("text").attr("y",e+25).attr("class","id id-host"),n.append("text").attr("y",e+55).attr("class","node-info-text")}(s,e),a}function O(t){!function(t){t.select(".node-icon").each((function(t){const e=(n=t,Object(a.isEmpty)(n.recoveryStatus)?function(t){const e=I[t.nodeState];return e||{icon:"",font:""}}(t):function(t){const e=t.recoveryStatus;if(!e||!e.state)return{icon:"",font:""};return L[e.state]||{icon:"",font:""}}(t));var n;d3.select(this).classed("icon-any",e.font===_).classed("fa-d3",e.font===E).text(e.icon)}))}(t),function(t){t.select(".node.member").classed("leader",t=>t.nodeState===s.NodeState.LEADER).classed("follower",t=>t.nodeState===s.NodeState.FOLLOWER).classed("candidate",t=>t.nodeState===s.NodeState.CANDIDATE).classed("other",t=>t.nodeState!==s.NodeState.LEADER&&t.nodeState!==s.NodeState.FOLLOWER&&t.nodeState!==s.NodeState.CANDIDATE)}(t),function(t){t.select(".id.id-host").each((function(t){t.labelNode=this})).text((function(t){return t.hostname})),t.select(".id-host-background").attr("width",(function(t){return d3.select(t.labelNode).node().getBBox().width+10})).attr("height",(function(t){return d3.select(t.labelNode).node().getBBox().height+10})).attr("x",(function(t){return d3.select(t.labelNode).node().getBBox().x-5})).attr("y",(function(t){return d3.select(t.labelNode).node().getBBox().y-5}))}(t),function(t){let e,n;t.select(".node-info-text").each((function(t){t.infoNode=this})).select((function(){return this.parentNode})).append("foreignObject").attr("width",(function(t){if(Object(a.isEmpty)(t.recoveryStatus))return 0;const s=f(C(t));return e=s.height,n=s.width,n})).attr("height",(function(t){return Object(a.isEmpty)(t.recoveryStatus)?0:e})).attr("x",(function(t){return-n/2})).attr("y",(function(t){return 78})).classed("hidden",(function(t){return Object(a.isEmpty)(t.recoveryStatus)})).style("font-size","12px").style("font-weight","400").style("text-align","center").style("padding","4px").style("background","#EEEEEE").style("border-radius","6px").attr("class","node-info-fo").append("xhtml:div").html((function(t){return C(t)})),t.select(".node-info-text").remove(),function(t){t.select(".node-info-fo").each((function(t){const e=d3.select(this);if(Object(a.isEmpty)(t.recoveryStatus))return void e.attr("width",0);const n=C(t),s=t.recoveryStatus.message&&t.recoveryStatus.message.length>40&&n!==t.recoveryStatus.message,r=s?n:t.recoveryStatus.message,o=f(n),N=f(t.recoveryStatus.message);e.on(".tooltip",null),s&&function(t,e,n,s,a){t.on("mouseover.tooltip",()=>{t.attr("width",a.width).attr("height",a.height).attr("x",-a.width/2).html(`<div>${e}</div>`)}),t.on("mouseout.tooltip",()=>{t.attr("width",n.width).attr("height",n.height).attr("x",-n.width/2).html(`<div>${s}</div>`)})}(e,t.recoveryStatus.message,o,r,N),e.attr("width",o.width).attr("height",o.height).attr("x",-o.width/2).html(`<div>${r}</div>`)}))}(t)}(t)}const L={[s.RecoveryState.SEARCHING_FOR_NODE]:{icon:"",font:E},[s.RecoveryState.WAITING_FOR_SNAPSHOT]:{icon:"",font:E},[s.RecoveryState.RECEIVING_SNAPSHOT]:{icon:"",font:E},[s.RecoveryState.APPLYING_SNAPSHOT]:{icon:"",font:E},[s.RecoveryState.BUILDING_SNAPSHOT]:{icon:"",font:E},[s.RecoveryState.SENDING_SNAPSHOT]:{icon:"",font:E},[s.RecoveryState.RECOVERY_OPERATION_FAILURE_WARNING]:{icon:"",font:_}},I={[s.NodeState.CANDIDATE]:{icon:"",font:_},[s.NodeState.NO_CONNECTION]:{icon:"",font:_},[s.NodeState.OUT_OF_SYNC]:{icon:"",font:_},[s.NodeState.READ_ONLY]:{icon:"",font:_},[s.NodeState.RESTRICTED]:{icon:"",font:_}};function C(t){return t.recoveryStatus.message&&t.recoveryStatus.message.length>40?t.recoveryStatus.message.substring(0,40)+"...":t.recoveryStatus.message||""}function f(t){const e=document.createElement("div");e.innerHTML=t,e.style.padding="4px",e.style.position="absolute",e.style.visibility="hidden",e.style.fontSize="12px",e.style.fontWeight="400",e.style.textAlign="center",e.style.height="auto",e.style.width="auto",e.style.whiteSpace="nowrap",document.body.appendChild(e);const n=e.getBoundingClientRect(),s=n.height,a=n.width;return document.body.removeChild(e),{height:s,width:a}}function h(t){t.enter().append("path").classed("link",!0),t.exit().remove()}function G(t,e){t.attr("class",t=>"link "+t.id.replaceAll(":","-")).attr("stroke",M).style("stroke-dasharray",D).style("marker-mid",t=>p(t,y.BIG)).attr("d",t=>function(t,e){const n=e.find(e=>e.address===t.source),s=e.find(e=>e.address===t.target),a=s.x-n.x,r=s.y-n.y,o=Math.sqrt(a*a+r*r),N=a/o,i=r/o,c=n.x+55*N,E=n.y+55*i,_=s.x-55*N,l=s.y-55*i;return"M"+c+","+E+"L"+(c+_)/2+","+(E+l)/2+"L"+_+","+l}(t,e))}const y={SMALL:{name:"small",size:3},BIG:{name:"big",size:5}};function g(t,e){t.append("svg:defs").append("svg:marker").attr("id","arrowhead_"+e.name).attr("viewBox",`0 0 ${2*e.size} ${2*e.size}`).attr("refX",e.size).attr("refY",e.size).attr("markerWidth",e.size).attr("markerHeight",e.size).attr("orient","auto-start-reverse").append("path").attr("d",`M 0 0 L ${2*e.size} ${e.size} L 0 ${2*e.size} z`).style("fill","var(--secondary-color)")}function p(t,e){if(t.status===s.LinkState.RECEIVING_SNAPSHOT)return`url(#arrowhead_${e.name})`}function M(t){return i[t.status]||"none"}function D(t){return c[t.status]||"none"}function R(t,e,n,s){t.attr("transform",(a,r)=>{const o=2*Math.PI*r/t.size(),N=e+Math.cos(o)*s,i=n+Math.sin(o)*s;return a.x=N,a.y=i,`translate(${N}, ${i})`})}function m(t,e){const n=Math.sqrt(3)/2,s=[[e+0,0],[e/2+0,e*n+0],[-e/2+0,e*n+0],[0-e,0],[-e/2+0,-e*n+0],[e/2+0,-e*n+0],[e+0,0],[e/2+0,e*n+0]];return t.selectAll("path.area").data([s]).enter().append("path").attr("class","node member").attr("stroke-width","10").attr("stroke-linejoin","round").attr("d",d3.line())}function v(){d3.select(document).selectAll(".node-info-fo").on(".tooltip",null)}}}]);