(window.webpackJsonp=window.webpackJsonp||[]).push([[34,79,217,218,255],{137:function(e,i,t){"use strict";t.r(i),t.d(i,"SimilarityResultType",(function(){return r}));const r={TERM_RESULT:"termResult",DOCUMENT_RESULT:"documentResult",ENTITY_RESULT:"entityResult",isResultDocumentType:e=>r.DOCUMENT_RESULT===e,isResultTermType:e=>r.TERM_RESULT===e}},138:function(e,i,t){"use strict";t.r(i),t.d(i,"SimilaritySearch",(function(){return a}));var r=t(86);class a{constructor(){this.type=r.SimilaritySearchType.SEARCH_TERM,this.predicate="",this.termOrSubject=""}isSearchAnalogicalType(){return r.SimilaritySearchType.isSearchAnalogicalType(this.type)}isSearchTermType(){return r.SimilaritySearchType.isSearchTermType(this.type)}isSearchEntityType(){return r.SimilaritySearchType.isSearchEntityType(this.type)}isSearchEntityPredicateType(){return r.SimilaritySearchType.isSearchEntityPredicateType(this.type)}isSearchDocumentType(){return r.SimilaritySearchType.isSearchDocumentType(this.type)}}},235:function(e,i){angular.module("graphdb.framework.rest.similarity.service",[]).factory("SimilarityRestService",t),t.$inject=["$http","$repositories"];function t(e){return{getIndexes:function(){return e.get("rest/similarity")},getSearchQueries:function(){return e.get("rest/similarity/config")},rebuildIndex:function(e){return i("PUT",e.name,e.options,e.selectQuery,e.searchQuery,e.analogicalQuery,e.stopList,e.infer,e.sameAs,e.type)},deleteIndex:function(i){return e.delete("rest/similarity?name="+i.name)},createIndex:i,getSamples:function(){return e.get("rest/similarity/samples")},getQuery:function(i){return e.get("rest/similarity/query",{params:{name:i.indexName,options:i.indexOptions,stopList:i.indexStopList,selectQuery:i.query,infer:i.queryInference,sameAs:i.querySameAs,type:i.viewType,analyzer:i.indexAnalyzer}})},saveSearchQuery:function(i){return e({method:"put",url:"rest/similarity/search-query",data:i})}};function i(i,t,r,a,s,c,n,l,o,y,p){return e({method:i,url:"rest/similarity",noCancelOnRouteChange:!0,data:{name:t,options:r,selectQuery:a,stopList:n,infer:l,sameAs:o,type:y,analyzer:p,searchQuery:s,analogicalQuery:c}})}}},237:function(e,i,t){"use strict";t.r(i);var r=t(0),a=t(86),s=t(137),c=t(74),n=t(72),l=t(107),o=t(138),y=t(67);function p(e,i,t,p,u,S,d,m,h,T,g,R,x,I){const E="http://www.ontotext.com/graphdb/similarity/",A="http://www.ontotext.com/graphdb/similarity/psi/",b=A+"any";e.pluginName="similarity",e.pluginIsActive=!0,e.isLoading=!1,e.selectedSimilarityIndex=void 0,e.similarityIndexStatus=c.SimilarityIndexStatus,e.similarityIndexType=n.SimilarityIndexType,e.similaritySearchType=a.SimilaritySearchType,e.searchType=a.SimilaritySearchType.SEARCH_TERM,e.similarityResultType=s.SimilarityResultType,e.resultType=s.SimilarityResultType.TERM_RESULT,e.info=g,e.isGraphDBRepository=void 0,e.canEditRepo=e.canWriteActiveRepo(),e.loadSimilarityIndexesTimer=void 0,e.loadSimilarityIndexes=()=>{e.isGraphDBRepository&&e.pluginIsActive&&h.getIndexes().success(i=>e.similarityIndexes=Object(l.mapIndexesResponseToSimilarityIndex)(i)).error(e=>t.error(getError(e),x.instant("similarity.could.not.get.indexes.error")))},e.reloadSimilarityIndexes=()=>{e.loadSimilarityIndexes(),e.loadSimilarityIndexesTimer||(e.loadSimilarityIndexesTimer=i((function(){e.$broadcast("checkIsActive"),"false"!==$("#indexes-table").attr("aria-expanded")&&e.loadSimilarityIndexes()}),5e3))},e.goToSimilarityIndex=i=>{(i.isBuiltStatus()||i.isOutdatedStatus()||i.isRebuildingStatus())&&(e.empty=!0,e.selectedSimilarityIndex!==i&&(e.lastSearch=void 0,e.selectedSimilarityIndex=i),i.isTextType()?e.searchType=a.SimilaritySearchType.SEARCH_TERM:i.isPredicationType()&&(e.searchType=a.SimilaritySearchType.SEARCH_ENTITY),(i.isTextType()||i.isPredicationType())&&$("#indexes-table").collapse("hide"))},e.performSearch=(i,r,a,s,c)=>{e.isLoading=!0,M(a,r);const n=q(i,r,a,s,c);I.getQueryResult(p.getActiveRepository(),n,"application/x-sparqlstar-results+json, application/sparql-results+json;q=0.9, */*;q=0.8").then(e=>H(e)).catch(e=>t.error(getError(e.data),x.instant("similarity.get.resource.error"))).finally(()=>e.isLoading=!1)},e.viewSearchQuery=()=>{let i;i=e.lastSearch.isSearchAnalogicalType()?e.selectedSimilarityIndex.analogicalQuery?e.selectedSimilarityIndex.analogicalQuery:e.searchQueries.analogical:e.selectedSimilarityIndex.searchQuery?e.selectedSimilarityIndex.searchQuery:e.searchQueries[e.selectedSimilarityIndex.type];let t=[],r="";t=i.match(/[a-zA-Z0-9-]+:<http:\/\/www.ontotext.com\/graphdb\/similarity\/instance\/>/),r=null==t?"similarity-index":t[0].substring(0,t[0].indexOf(":"));const s=i.replace("?index",r+":"+e.selectedSimilarityIndex.name).replace("?query",e.lastSearch.termOrSubject).replace("?searchType",(e.selectedSimilarityIndex.isTextType()?":":"psi:")+(e.lastSearch.isSearchEntityPredicateType()?a.SimilaritySearchType.SEARCH_ENTITY:e.lastSearch.type)).replace("?resultType",e.selectedSimilarityIndex.isTextType()?":"+e.resultType:"psi:entityResult").replace("?parameters",Q(e.searchParameters?e.searchParameters:"")).replace("?psiPredicate",e.lastSearch.predicate?C(e.lastSearch.predicate):C(b)).replace("?givenSubject",C(e.analogicalSubject)).replace("?givenObject",C(e.analogicalObject)).replace("?searchSubject",C(e.searchSubject));m.open({templateUrl:"pages/viewQuery.html",controller:"ViewQueryCtrl",resolve:{query:()=>s}})},e.deleteSimilarityIndex=i=>{d.openSimpleModal({title:x.instant("common.confirm"),message:x.instant("similarity.delete.index.warning",{name:i.name}),warning:!0}).result.then((function(){h.deleteIndex(i).then(()=>e.loadSimilarityIndexes()).catch(e=>t.error(getError(e)))}))},e.viewCreateQuery=e=>{h.getQuery({indexName:e.name,indexOptions:e.options,query:e.selectQuery,indexStopList:e.stopList,queryInference:e.infer,querySameAs:e.sameAs,viewType:e.type,indexAnalyzer:e.analyzer}).success(e=>{m.open({templateUrl:"pages/viewQuery.html",controller:"ViewQueryCtrl",resolve:{query:()=>e}})})},e.rebuildIndex=i=>{i.searchQuery||(i.searchQuery=i.type?e.searchQueries[i.type]:e.searchQueries.text),d.openSimpleModal({title:x.instant("common.confirm"),message:Object(r.decodeHTML)(x.instant("similarity.rebuild.index.warning",{name:i.name})),warning:!0}).result.then(()=>{i.status=c.SimilarityIndexStatus.REBUILDING,h.rebuildIndex(i).catch(e=>t.error(getError(e)))})},e.setPluginIsActive=i=>{e.pluginIsActive=i},e.encodeURIComponent=e=>encodeURIComponent(e),e.copyToClipboardResult=e=>{d.openCopyToClipboardModal(e)},e.trimIRI=e=>_.trim(e,"<>"),e.updateSearchType=i=>{e.searchType=i},e.updateResultType=i=>{e.resultType=i},e.editSimilarityIndex=e=>{f(e)},e.cloneSimilataryIndex=e=>{f(e,!0)},e.setPsiSubject=i=>{e.psiSubject=i},e.setAnalogicalSubject=i=>{e.analogicalSubject=i},e.setAnalogicalObject=i=>{e.analogicalObject=i};const f=(e,i=!1)=>{const t={selectQuery:e.selectQuery,options:e.options,name:e.name,editSearchQuery:!i,infer:e.infer,sameAs:e.sameAs,stopList:e.stopList,type:e.type,analyzer:e.analyzer,searchQuery:e.searchQuery?e.searchQuery:"",analogicalQuery:e.analogicalQuery?e.analogicalQuery:""};S.path("similarity/index/create").search(t)},w=()=>{const i=e.getActiveRepository();i&&e.activeRepository!==i&&(e.canEditRepo=e.canWriteActiveRepo(),e.activeRepository=i,e.isGraphDBRepository=j(),e.isGraphDBRepository&&(u.isLicenseValid()&&e.reloadSimilarityIndexes(),v()))},v=()=>{h.getSearchQueries().success(i=>e.searchQueries=i).error(e=>t.error(getError(e),x.instant("similarity.could.not.get.search.queries.error")))},Q=e=>'"'+e+'"',C=e=>void 0===e||e.startsWith("<<")&&e.endsWith(">>")?e:"<"+e+">",j=()=>e.getActiveRepository()&&!e.isActiveRepoOntopType()&&!e.isActiveRepoFedXType(),L=[];L.push(e.$on("repositoryIsSet",w));e.$on("$destroy",()=>{O(),e.loadSimilarityIndexesTimer&&i.cancel(e.loadSimilarityIndexesTimer)});const O=()=>{L.forEach(e=>e())};L.push(e.$on("autocompleteStatus",()=>{u.isLicenseValid()&&(e.getAutocompletePromise=T.checkAutocompleteStatus())}));L.push(e.$watch("searchType",()=>{e.empty=!0}));const P=e.$watch(e.getActiveRepositoryObject,e=>{e&&(w(),P())}),q=(i,t,r,c,n)=>{const l={query:N(e.lastSearch.type),$index:C("http://www.ontotext.com/graphdb/similarity/instance/"+i.name),$query:e.lastSearch.termOrSubject,$searchType:C((e.selectedSimilarityIndex.isTextType()?E:A)+(a.SimilaritySearchType.isSearchEntityPredicateType(r)?a.SimilaritySearchType.SEARCH_ENTITY:r)),$resultType:C(e.selectedSimilarityIndex.isTextType()?E+c:A+s.SimilarityResultType.ENTITY_RESULT),$parameters:Q(n)};return a.SimilaritySearchType.isSearchEntityPredicateType(r)&&(l.$psiPredicate=e.lastSearch.predicate?C(e.lastSearch.predicate):C(b)),a.SimilaritySearchType.isSearchAnalogicalType(r)&&(e.searchSubject=t,l.$givenSubject=C(e.analogicalSubject),l.$givenObject=C(e.analogicalObject),l.$searchSubject=C(t)),l},M=(i,t)=>{e.lastSearch=new o.SimilaritySearch,e.lastSearch.type=i,a.SimilaritySearchType.isSearchEntityPredicateType(i)&&(e.lastSearch.predicate=t),e.lastSearch.termOrSubject=D(e.lastSearch.type,t,e.psiSubject)},N=i=>{let t;return t=a.SimilaritySearchType.isSearchAnalogicalType(i)?e.selectedSimilarityIndex.analogicalQuery?e.selectedSimilarityIndex.analogicalQuery:e.searchQueries.analogical:e.selectedSimilarityIndex.searchQuery?e.selectedSimilarityIndex.searchQuery:e.searchQueries[e.selectedSimilarityIndex.type],t},D=(e,i,t)=>{let r=i;return r=a.SimilaritySearchType.isSearchEntityPredicateType(e)?t:a.SimilaritySearchType.isSearchTermType(e)?Q(r):C(r),r},H=i=>{e.yasguiConfig={showEditorTabs:!1,showToolbar:!1,showResultTabs:!1,showQueryButton:!1,downloadAsOn:!1,showResultInfo:!1,componentId:"similarity-list-component",maxPersistentResponseSize:0,render:y.RenderingMode.YASR,sparqlResponse:i.data}}}angular.module("graphdb.framework.similarity.controllers.list",[]).controller("SimilarityCtrl",p),p.$inject=["$scope","$interval","toastr","$repositories","$licenseService","$location","ModalService","$uibModal","SimilarityRestService","AutocompleteRestService","productInfo","RDF4JRepositoriesRestService","$translate","SparqlRestService"]},325:function(e,i,t){"use strict";t.r(i);t(7),t(28),t(34),t(235),t(237),t(245),t(93);angular.module("graphdb.framework.similarity",["graphdb.framework.core.controllers","graphdb.framework.core.directives","graphdb.framework.rest.similarity.service","graphdb.framework.similarity.controllers.create","graphdb.framework.similarity.controllers.list","graphdb.framework.core.directives.yasgui-component"])},86:function(e,i,t){"use strict";t.r(i),t.d(i,"SimilaritySearchType",(function(){return r}));const r={SEARCH_TERM:"searchTerm",SEARCH_ANALOGICAL:"searchAnalogical",SEARCH_ENTITY:"searchEntity",SEARCH_ENTITY_PREDICATE:"searchEntityPredicate",SEARCH_DOCUMENT:"searchDocumentID",isSearchTermType:e=>r.SEARCH_TERM===e,isSearchAnalogicalType:e=>r.SEARCH_ANALOGICAL===e,isSearchEntityType:e=>r.SEARCH_ENTITY===e,isSearchEntityPredicateType:e=>r.SEARCH_ENTITY_PREDICATE===e,isSearchDocumentType:e=>r.SEARCH_DOCUMENT===e}}}]);